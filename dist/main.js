(()=>{const e=document.querySelector("[data-edit-title]"),t=(document.querySelector("[data-title-to-edit]"),document.querySelector("[data-done-button]")),d=document.querySelector("[data-todos]"),o=document.querySelector("[data-list-input]"),r=document.querySelector("[data-my-projects]"),n=document.querySelector("[data-delete-button]"),a=document.querySelector("[data-project-title]"),c=document.querySelector("[data-add-form]"),l=(document.querySelector("[data-submit-button]"),document.querySelector("[data-list-of-todos]"));var s=[{name:"today",selected:!0,tasks:[]}],i=0;function u(e){this.name=e,this.selected=!1,this.tasks=[]}function m(e,t,o,r){this.title=e,this.dueDate=t,this.priority=o,this.completed=!1,this.specialId=r,this.deleteTask=function(){let e=document.querySelector(".selectedTask");s.forEach((t=>{t.name===e.innerHTML&&(nameProject=t)})),nameProject.tasks.forEach((e=>{if(e===this)for(var t=0;t<nameProject.tasks.length;t++)nameProject.tasks[t]===this&&nameProject.tasks.splice(t,1)})),p()},this.editTask=function(){!function(e){if(null!==document.querySelector(".addEditForm"))return void document.querySelector(".addEditForm").parentNode.removeChild(document.querySelector(".addEditForm"));const t=document.querySelector("#formEditTemplate").content.cloneNode(!0);d.appendChild(t),function(e){document.querySelector(".addEditForm").addEventListener("submit",(t=>{t.preventDefault();const d=document.querySelector(".addEditForm").elements.title.value,o=document.querySelector(".addEditForm").elements.dueDate.value,r=document.querySelector(".addEditForm").elements.priority.value;document.querySelector(".addEditForm").reset(),e.title=d,e.dueDate=o,e.priority=r,p(),console.log(s),document.querySelector(".addEditForm").parentNode.removeChild(document.querySelector(".addEditForm"))}))}(e)}(this)},this.makeCompleted=function(){if(this.completed)return this.completed=!1,void p();this.completed=!0,p()}}function p(){if(null===document.querySelector(".selectedTask"))return void(l.innerHTML="");const e=document.querySelector(".selectedTask").innerHTML;s.forEach((t=>{t.name===e&&(projectSelectedName=t)})),l.innerHTML="",projectSelectedName.tasks.forEach((e=>{!function(e){const t=document.querySelector("#taskTemplate").content.cloneNode(!0);let d=t.querySelector("li");d.classList.add(e.priority),d.dataset.specialId=e.specialId,t.querySelector("[data-task-content]").innerHTML=`${e.title} ${e.dueDate}`;let o=t.querySelector("[data-todo-btns]"),r=o.querySelector("[data-delete-task]"),n=o.querySelector("[data-edit-task]"),a=t.querySelector("[data-tick-button]");e.completed&&(a.dataset.completed="true"),!1===e.completed&&(a.dataset.completed="false"),r.addEventListener("click",(()=>{let t=r.parentNode.parentNode;t.parentNode.removeChild(t),e.deleteTask()})),n.addEventListener("click",(()=>{e.editTask()})),a.addEventListener("click",(()=>{e.makeCompleted()})),l.appendChild(t)}(e)})),function(e){let t=projectSelectedName.tasks.length;document.querySelector("[data-task-remaining]").innerHTML=1===t?`${t} task remaining`:`${t} tasks remaining`}(),localStorage.setItem("projects",JSON.stringify(s))}e.addEventListener("click",(()=>{let d=document.querySelector("[data-title-to-edit]");d.parentNode.removeChild(d);let o=document.createElement("input");o.classList.add("inputNewList"),o.dataset.titleToInput="",null!==e.parentNode.querySelector("[data-done-button")&&e.parentNode.removeChild(t);let r=document.createElement("button");r.dataset.doneButton="",r.innerHTML="Done",r.classList.add("addButtono"),r.addEventListener("click",(()=>{let t=o.value;e.parentNode.removeChild(r),e.parentNode.removeChild(o);let d=document.createElement("divs");d.classList.add("menuHeaderTitle"),d.dataset.titleToEdit="",d.innerHTML=t,e.parentNode.prepend(d)})),e.parentNode.prepend(r),e.parentNode.prepend(o)})),o.addEventListener("keydown",(e=>{if("Enter"===e.key){if(""===o.value)return;if(function(e){e=e.toLowerCase();let t=!1;return s.forEach((d=>{d.name===e&&(t=!0)})),t}(o.value))return void(o.value="");{!function(e){let t=document.createElement("li");t.id=e,t.innerHTML=e,r.appendChild(t)}(o.value);let e=o.value;e=e.toLowerCase();let t=new u(e);o.value="",s.push(t),console.log(s)}}})),function(e){e.forEach((e=>{let t=document.createElement("li");t.innerHTML=e.name,r.appendChild(t)}))}(s),r.addEventListener("click",(e=>{if("myTasksList"!==(c=e.target).className&&(a.innerHTML=c.innerHTML),null===document.querySelector(".selectedTask")&&r.firstElementChild.classList.add("selectedTask"),"myTasksList"!==e.target.classList[0]){var t=document.querySelector(".selectedTask");t.classList.remove("selectedTask"),e.target.classList.add("selectedTask");var d,o,n=document.querySelector(".selectedTask");d=n.innerHTML,o=t.innerHTML,s.forEach((e=>{e.name===d&&(e.selected=!0),e.name===o&&(e.selected=!1)})),p()}var c})),n.addEventListener("click",(()=>{let e=document.querySelector(".selectedTask");e.parentNode.removeChild(e),console.log(e.innerHTML),s.forEach((t=>{if(t.name===e.innerHTML.toLowerCase())for(var d=0;d<s.length;d++)s[d]===t&&s.splice(d,1)})),p()})),c.addEventListener("click",(()=>{if(null!==document.querySelector(".addForm"))return void document.querySelector(".addForm").parentNode.removeChild(document.querySelector(".addForm"));const e=document.querySelector("#formTemplate").content.cloneNode(!0);d.appendChild(e),document.querySelector(".addForm").addEventListener("submit",(e=>{e.preventDefault();const t=document.querySelector(".addForm").elements.title.value,d=document.querySelector(".addForm").elements.dueDate.value,o=document.querySelector(".addForm").elements.priority.value;document.querySelector(".addForm").reset(),function(e,t,d){let o=new m(e,t,d,i);i++;const r=document.querySelector(".selectedTask").innerHTML;s.forEach((e=>{e.name===r&&(projectSelectedName=e)})),projectSelectedName.tasks.push(o)}(t,d,o),p(),console.log(s)}))})),p(),document.querySelector("[data-clear-tasks]").addEventListener("click",(()=>{let e=document.querySelector(".selectedTask");s.forEach((t=>{t.name===e.innerHTML&&(selectedProjectName=t)})),selectedProjectName.tasks.forEach((e=>{!0===e.completed&&e.deleteTask()}))})),r.firstElementChild.classList.add("selectedTask")})();